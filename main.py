from MyRBM.rbm0 import RBM
import numpy as np

rbm = RBM(4, 2)

# rbm.W = np.array([
#     [1.0, -1],
#     [-1, 1]
# ])
#
# rbm.Bv *= 0
# rbm.Bh *= 0
#
# print(rbm.sample_x([1, 0]))


# data = np.array([
#     [0,0,0,1,1,0],
#     [0,0,1,0,1,0],
#     [0,1,0,0,1,0],
#     [1,0,0,0,1,0],
#     [0,0,0,1,1,0],
#     [0,0,1,0,1,0],
#     [0,1,0,0,1,0],
#     [1,0,0,0,1,0],
#     [0,0,0,1,1,0],
#     [0,0,1,0,1,0],
#     [0,1,0,0,1,0],
#     [1,0,0,0,1,0],
#     [0,0,0,0,0,1],
#     [0,0,1,1,0,1],
#     [0,1,0,1,0,1],
#     [1,0,0,1,0,1],
#     [0,1,1,0,0,1],
#     [0,1,1,1,0,1],
#     [1,0,1,0,0,1],
#     [1,0,1,1,0,1],
#     [1,1,0,0,0,1],
#     [1,1,0,1,0,1],
#     [1,1,1,0,0,1],
#     [1,1,1,1,0,1],
# ])

data = np.array([
    [0, 1, 0, 1],
    [1, 0, 1, 0],
])

rbm.fit(data, epochs=1000, gibb_samples=1, lr=1e-1, momentum=0)

# print(rbm.un_p([1, 0, 0, 0, 1, 0]))
# print(rbm.un_p([1, 0, 0, 0, 0, 1]))
# print()
#
# print(rbm.un_p([0, 1, 0, 0, 1, 0]))
# print(rbm.un_p([0, 1, 0, 0, 0, 1]))
# print()
#
# print(rbm.un_p([1, 1, 1, 0, 0, 1]))
# print(rbm.un_p([1, 1, 1, 0, 1, 0]))
# print()


print('here')

a1 = rbm.un_p([0, 1, 0, 1])
a2 = rbm.un_p([0, 1, 1, 0])
b1 = rbm.un_p([1, 0, 1, 0])
b2 = rbm.un_p([1, 0, 0, 1])

print(a1 / (a1 + a2), b1 / (b1 + b2))
